almost same code as beazley_3_server.py